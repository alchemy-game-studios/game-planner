# Query type for fetching data
type Query {
  hello: Hello

  # Entity queries - single and all
  universe(obj: IdInput!): Entity
  universes: [Entity!]!
  place(obj: IdInput!): Entity
  places: [Entity!]!
  character(obj: IdInput!): Entity
  characters: [Entity!]!
  item(obj: IdInput!): Entity
  items: [Entity!]!
  tag(obj: IdInput!): Entity
  tags: [Entity!]!
  event(obj: IdInput!): Entity
  events: [Entity!]!
  narrative(obj: IdInput!): Entity
  narratives: [Entity!]!

  # Search entities by name
  searchEntities(query: String!, type: String): [Entity!]!
}

# Mutation type for modifying data
type Mutation {
  submitText(input: SubmitText!): Response

  # Universe mutations
  addUniverse(universe: UniverseInput!): Response
  editUniverse(universe: UniverseInput!): Response
  removeUniverse(universe: UniverseInput!): Response

  # Place mutations
  addPlace(place: PlaceInput!): Response
  editPlace(place: PlaceInput!): Response
  removePlace(place: PlaceInput!): Response

  # Character mutations
  addCharacter(character: CharacterInput!): Response
  editCharacter(character: CharacterInput!): Response
  removeCharacter(character: CharacterInput!): Response

  # Item mutations
  addItem(item: ItemInput!): Response
  editItem(item: ItemInput!): Response
  removeItem(item: ItemInput!): Response

  # Tag mutations
  addTag(tag: TagInput!): Response
  editTag(tag: TagInput!): Response
  removeTag(tag: TagInput!): Response

  # Event mutations
  addEvent(event: EventInput!): Response
  editEvent(event: EventInput!): Response
  removeEvent(event: EventInput!): Response

  # Narrative mutations
  addNarrative(narrative: NarrativeInput!): Response
  editNarrative(narrative: NarrativeInput!): Response
  removeNarrative(narrative: NarrativeInput!): Response

  # Relationship mutations
  relateContains(relation: RelatableInput!): Response
  relateTagged(relation: TagRelationInput!): Response

  # Event relationship mutations
  relateOccursAt(relation: EventLocationInput!): Response
  relateInvolves(relation: EventParticipantsInput!): Response

  # Image mutations
  reorderImages(entityId: String!, imageIds: [String!]!): [Image!]!
  removeImage(imageId: String!): Response
}

# Common types
type Hello {
  message: String!
}

type Response {
  message: String!
}

# Entity type returned from queries
type Entity {
  id: String!
  properties: EntityProperties!
  contents: [ContentItem!]!
  allContents: [DescendantContent!]!
  tags: [EntityProperties!]!
  images: [Image!]!
  allImages: [EntityImage!]!
  # Event-specific fields (populated for Event entities)
  locations: [EntityProperties!]
  participants: [Participant!]
  # Reverse lookup: events this entity is involved in
  events: [EntityProperties!]
  # For Events: their parent narrative
  parentNarrative: EntityProperties
}

type EntityProperties {
  id: String!
  name: String!
  description: String
  type: String
  # Event-specific properties
  startDate: String
  endDate: String
}

# Participant type for event participants (characters and items)
type Participant {
  id: String!
  name: String!
  description: String
  type: String
  _nodeType: String!
}

type ContentItem {
  _nodeType: String!
  properties: EntityProperties!
}

# Content item with depth info (for descendant content)
type DescendantContent {
  _nodeType: String!
  properties: EntityProperties!
  parentId: String!
  parentName: String!
  depth: Int!
}

# Image type for entity images
type Image {
  id: String!
  filename: String!
  url: String!
  mimeType: String!
  size: Int!
  rank: Int!
  uploadedAt: String
}

# Image with source entity info (for descendant images)
type EntityImage {
  id: String!
  filename: String!
  url: String!
  mimeType: String!
  size: Int!
  rank: Int!
  uploadedAt: String
  entityId: String!
  entityName: String!
  entityType: String!
}

# Input types
input IdInput {
  id: String!
}

input SubmitText {
  text: String!
}

input UniverseInput {
  id: String!
  name: String
  description: String
  type: String
}

input PlaceInput {
  id: String!
  name: String
  description: String
  type: String
}

input CharacterInput {
  id: String!
  name: String
  description: String
  type: String
}

input ItemInput {
  id: String!
  name: String
  description: String
  type: String
}

input TagInput {
  id: String!
  name: String
  description: String
  type: String
}

input EventInput {
  id: String!
  name: String
  description: String
  type: String
  startDate: String
  endDate: String
}

input NarrativeInput {
  id: String!
  name: String
  description: String
  type: String
}

input RelatableInput {
  id: String!
  childIds: [String!]!
}

input TagRelationInput {
  id: String!
  tagIds: [String!]!
}

input EventLocationInput {
  eventId: String!
  placeIds: [String!]!
}

input EventParticipantsInput {
  eventId: String!
  characterIds: [String!]
  itemIds: [String!]
}
